{"name": "test_url_redirect_using_xss_from_data_wrapper[firefox-https://pentest-ground.com:81//services]", "status": "skipped", "statusDetails": {"message": "XFAIL page fails to load, but url loads with redirect parameter\n\nAssertionError: Page URL expected not to be 'https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg=='\nActual value: https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg== \nCall log:\nPageAssertions.not_to_have_url with timeout 5000ms\n  - waiting for locator(\":root\")\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"", "trace": "self = <tests.client.url_redirection.TestForcedURLRedirect object at 0x104d2f2d0>\npage = <Page url='https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg=='>\ntarget_url = 'https://pentest-ground.com:81//services'\n\n    @pytest.mark.xfail(reason=\"page fails to load, but url loads with redirect parameter\")\n    def test_url_redirect_using_xss_from_data_wrapper(self, page: Page, target_url):\n        with allure.step(\"Visit site and attempt forced-redirect using cross-site-script from data-wrapper\"):\n            forced_redirect_url = f\"{target_url}/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n            page.goto(forced_redirect_url)\n>           expect(page).not_to_have_url(f\"{forced_redirect_url}\"), f\"Vulnerability found! Forced redirected to {forced_redirect_url} was successful\"\nE           AssertionError: Page URL expected not to be 'https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg=='\nE           Actual value: https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg== \nE           Call log:\nE           PageAssertions.not_to_have_url with timeout 5000ms\nE             - waiting for locator(\":root\")\nE             -   locator resolved to <html>…</html>\nE             -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\nE             -   locator resolved to <html>…</html>\nE             -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\nE             -   locator resolved to <html>…</html>\nE             -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\nE             -   locator resolved to <html>…</html>\nE             -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\nE             -   locator resolved to <html>…</html>\nE             -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\nE             -   locator resolved to <html>…</html>\nE             -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\nE             -   locator resolved to <html>…</html>\nE             -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\nE             -   locator resolved to <html>…</html>\nE             -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\nE             -   locator resolved to <html>…</html>\nE             -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n\nurl_redirection.py:135: AssertionError"}, "description": "Test for client-side URL redirection", "steps": [{"name": "Visit site and attempt forced-redirect using cross-site-script from data-wrapper", "status": "failed", "statusDetails": {"message": "AssertionError: Page URL expected not to be 'https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg=='\nActual value: https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg== \nCall log:\nPageAssertions.not_to_have_url with timeout 5000ms\n  - waiting for locator(\":root\")\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n  -   locator resolved to <html>…</html>\n  -   unexpected value \"https://pentest-ground.com:81//services/redirect.php?url=data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+Cg==\"\n\n", "trace": "  File \"/Users/pablovergara/Desktop/automation/vulcanite/tests/client/url_redirection.py\", line 135, in test_url_redirect_using_xss_from_data_wrapper\n    expect(page).not_to_have_url(f\"{forced_redirect_url}\"), f\"Vulnerability found! Forced redirected to {forced_redirect_url} was successful\"\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/playwright/sync_api/_generated.py\", line 18245, in not_to_have_url\n    self._sync(\n  File \"/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/playwright/_impl/_sync_base.py\", line 115, in _sync\n    return task.result()\n           ^^^^^^^^^^^^^\n  File \"/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/playwright/_impl/_assertions.py\", line 131, in not_to_have_url\n    await self._not.to_have_url(urlOrRegExp, timeout)\n  File \"/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/playwright/_impl/_assertions.py\", line 120, in to_have_url\n    await self._expect_impl(\n  File \"/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/playwright/_impl/_assertions.py\", line 70, in _expect_impl\n    raise AssertionError(\n"}, "start": 1716688416028, "stop": 1716688421306}], "parameters": [{"name": "browser_name", "value": "'firefox'"}, {"name": "target_url", "value": "'https://pentest-ground.com:81//services'"}], "start": 1716688416028, "stop": 1716688421309, "uuid": "804cd881-50e7-49a1-8bcc-0d076d7e5e40", "historyId": "664af6ac09f285fdb3c9adad50b165d3", "testCaseId": "e65480f4e0a5d9edc84b86adcb4ae5b7", "fullName": "tests.client.url_redirection.TestForcedURLRedirect#test_url_redirect_using_xss_from_data_wrapper", "labels": [{"name": "severity", "value": "critical"}, {"name": "tag", "value": "@pytest.mark.xfail(reason='page fails to load, but url loads with redirect parameter')"}, {"name": "tag", "value": "security"}, {"name": "parentSuite", "value": "tests.client"}, {"name": "suite", "value": "url_redirection"}, {"name": "subSuite", "value": "TestForcedURLRedirect"}, {"name": "host", "value": "Pablos-MBP"}, {"name": "thread", "value": "5647-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "tests.client.url_redirection"}], "links": [{"type": "link", "url": "https://owasp.boireau.io/4-web_application_security_testing/11-client-side_testing/04-testing_for_client-side_url_redirect", "name": "Test for client-side URL redirection (WSTG-CLNT-04)"}]}